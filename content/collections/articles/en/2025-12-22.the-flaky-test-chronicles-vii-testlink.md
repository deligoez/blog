---
id: 139218a4-3d13-4bdd-bd43-0d56a5928cdd
blueprint: articles
title: 'The Flaky Test Chronicles VII: TestLink'
subtitle: 'Cmd+Click Your Way Between Tests and Production'
show_toc: true
toc_levels:
  - 1
updated_by: b8f3533e-0fcf-42b9-a3d8-c8691deaf917
updated_at: 1766380901
og_generator_image: the-flaky-test-chronicles-vii-testlink.jpg
content:
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'The Navigation Problem'
  -
    type: blockquote
    content:
      -
        type: paragraph
        attrs:
          textAlign: left
        content:
          -
            type: text
            text: 'Finding a test should take 5 seconds. Not 5 minutes.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'In '
      -
        type: text
        marks:
          -
            type: link
            attrs:
              href: /articles/the-flaky-test-chronicles-vi-organization
              rel: null
              target: null
              title: null
        text: 'Part VI'
      -
        type: text
        text: ', we tackled the organization problem: 1,953 test files scattered across directories with inconsistent naming. We fixed the structure. Tests now live where they should.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'But there''s another problem.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'You''re staring at '
      -
        type: text
        marks:
          -
            type: code
        text: ApplicationBuilder::build()
      -
        type: text
        text: '. Which tests cover this method? You could grep. You could Cmd+Shift+F. You could open the test directory and start scrolling.'
  -
    type: set
    attrs:
      id: tl001
      values:
        type: thought
        content:
          -
            type: paragraph
            content:
              -
                type: text
                text: 'There''s got to be a test for this...'
        position: center-left
  -
    type: set
    attrs:
      id: tl002
      values:
        type: thought
        content:
          -
            type: paragraph
            content:
              -
                type: text
                text: 'ApplicationBuilderTest? ApplicationTest? BuilderTest?'
        position: center-right
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Or you could just... click.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'What if every production method had a clickable link to its tests? What if every test had a clickable link to the code it covers?'
  -
    type: set
    attrs:
      id: tl003
      values:
        type: sidenote
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'The Cmd+Click Promise: Click a link in production code, land in the test. Click a link in a test, land in the production code. Both directions. Instantly.'
        style: note
        position: right
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'This is what '
      -
        type: text
        marks:
          -
            type: link
            attrs:
              href: 'https://link.testflowlabs.dev/'
              rel: null
              target: _blank
              title: null
        text: TestLink
      -
        type: text
        text: ' solves.'
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Enter TestLink'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'TestLink is a CLI tool that creates bidirectional navigation links between your production code and tests. Add an attribute to your production method, add a corresponding marker to your test, and you get Cmd+Click navigation in your IDE.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Here''s what it looks like in practice:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          // In production code
          class UserService
          {
              /**
               * @see \Tests\UserServiceTest::test_creates_user      <- Cmd+Click
               * @see \Tests\UserServiceTest::test_validates_email   <- Cmd+Click
               */
              public function create(array $data): User
              {
                  // Which tests verify this method? Just click above.
              }
          }
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          // In test code
          /**
           * @see \App\Services\UserService::create   <- Cmd+Click
           */
          public function test_creates_user(): void
          {
              // What does this test cover? Just click above.
          }
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'No grepping. No scrolling. No guessing.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'TestLink offers four CLI commands:'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: code
                text: 'testlink report'
              -
                type: text
                text: ' - View all coverage links in your codebase'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: code
                text: 'testlink validate'
              -
                type: text
                text: ' - Check that all links point to real code'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: code
                text: 'testlink sync'
              -
                type: text
                text: ' - Auto-generate links bidirectionally'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: code
                text: 'testlink pair'
              -
                type: text
                text: ' - Resolve placeholder markers for TDD workflows'
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Installation: The Two-Package Pattern'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'TestLink uses two separate packages. This isn''t an accident - it''s critical for production safety.'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          # Production dependency - always available
          composer require testflowlabs/test-attributes

          # Dev dependency - CLI tools
          composer require --dev testflowlabs/testlink
  -
    type: set
    attrs:
      id: tl004
      values:
        type: sidenote
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Why two packages?'
              -
                type: text
                text: ' '
              -
                type: hardBreak
              -
                type: text
                text: 'The '
              -
                type: text
                marks:
                  -
                    type: code
                text: '#[TestedBy]'
              -
                type: text
                text: ' attribute lives in production code. If it''s in a dev-only package, '
              -
                type: text
                marks:
                  -
                    type: code
                text: 'composer install --no-dev'
              -
                type: text
                text: ' will break your app with a ''Class not found'' error. The '
              -
                type: text
                marks:
                  -
                    type: code
                text: test-attributes
              -
                type: text
                text: ' package is tiny (just attributes) and safe for production.'
        style: warning
        position: right
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Your '
      -
        type: text
        marks:
          -
            type: code
        text: composer.json
      -
        type: text
        text: ' should look like this:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          {
              "require": {
                  "php": "^8.2",
                  "testflowlabs/test-attributes": "^1.0"
              },
              "require-dev": {
                  "phpunit/phpunit": "^12.0",
                  "testflowlabs/testlink": "^1.0"
              }
          }
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        marks:
          -
            type: bold
        text: 'Common mistake:'
      -
        type: text
        text: ' Installing only '
      -
        type: text
        marks:
          -
            type: code
        text: testflowlabs/testlink
      -
        type: text
        text: ' as a dev dependency. This pulls in '
      -
        type: text
        marks:
          -
            type: code
        text: test-attributes
      -
        type: text
        text: ' as a transitive dev dependency - which breaks in production.'
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Our First Link'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Let''s wire up a real example from our codebase. We''ll link a state machine guard to its tests.'
  -
    type: heading
    attrs:
      textAlign: left
      level: 2
    content:
      -
        type: text
        text: 'Step 1: Add #[TestedBy] to Production'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          <?php
          // app/Machines/Application/Guards/HasFarmerLimitGuard.php

          namespace App\Machines\Application\Guards;

          use TestFlowLabs\TestingAttributes\TestedBy;
          use Tests\Machines\Application\Guards\HasFarmerLimitGuardTest;

          class HasFarmerLimitGuard
          {
              #[TestedBy(HasFarmerLimitGuardTest::class, 'test_allows_when_limit_available')]
              #[TestedBy(HasFarmerLimitGuardTest::class, 'test_blocks_when_limit_exceeded')]
              public function check(Application $application): bool
              {
                  return $application->farmer->availableLimit() > 0;
              }
          }
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'The '
      -
        type: text
        marks:
          -
            type: code
        text: '#[TestedBy]'
      -
        type: text
        text: ' attribute takes two arguments: the test class and the test method name. You can stack multiple attributes for methods covered by multiple tests.'
  -
    type: heading
    attrs:
      textAlign: left
      level: 2
    content:
      -
        type: text
        text: 'Step 2: Add #[LinksAndCovers] to Tests'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          <?php
          // tests/Machines/Application/Guards/HasFarmerLimitGuardTest.php

          namespace Tests\Machines\Application\Guards;

          use App\Machines\Application\Guards\HasFarmerLimitGuard;
          use TestFlowLabs\TestingAttributes\LinksAndCovers;
          use Tests\TestCase;

          class HasFarmerLimitGuardTest extends TestCase
          {
              #[LinksAndCovers(HasFarmerLimitGuard::class, 'check')]
              public function test_allows_when_limit_available(): void
              {
                  // Arrange
                  $farmer = Farmer::factory()->withLimit(10000)->create();
                  $application = Application::factory()->for($farmer)->create();

                  // Act
                  $result = (new HasFarmerLimitGuard())->check($application);

                  // Assert
                  $this->assertTrue($result);
              }

              #[LinksAndCovers(HasFarmerLimitGuard::class, 'check')]
              public function test_blocks_when_limit_exceeded(): void
              {
                  // Arrange
                  $farmer = Farmer::factory()->withLimit(0)->create();
                  $application = Application::factory()->for($farmer)->create();

                  // Act
                  $result = (new HasFarmerLimitGuard())->check($application);

                  // Assert
                  $this->assertFalse($result);
              }
          }
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Now both sides are linked. Production knows which tests verify it. Tests know which production code they cover.'
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Running the Report'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'The '
      -
        type: text
        marks:
          -
            type: code
        text: 'testlink report'
      -
        type: text
        text: ' command shows you all coverage links in your codebase:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink report

            Coverage Links Report
            ---------------------

            App\Machines\Application\Guards\HasFarmerLimitGuard
              check()
              -> Tests\Machines\Application\Guards\HasFarmerLimitGuardTest::test_allows_when_limit_available
              -> Tests\Machines\Application\Guards\HasFarmerLimitGuardTest::test_blocks_when_limit_exceeded

            App\Services\CreditBureau\CreditBureauService
              fetchReport()
              -> Tests\Services\CreditBureau\CreditBureauServiceTest::test_fetches_credit_report
              -> Tests\Services\CreditBureau\CreditBureauServiceTest::test_handles_bureau_timeout

            Summary
            -------
              Methods with tests:       2
              Total test links:         4

            OK Report complete.
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'For a codebase with 1,953 test files, you can filter by path:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink report --path=app/Machines
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'For CI integration, use JSON output:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink report --json > coverage-links.json
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Validation'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Links rot. Methods get renamed. Tests get deleted. '
      -
        type: text
        marks:
          -
            type: code
        text: 'testlink validate'
      -
        type: text
        text: ' catches these problems:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink validate

            Validation Report
            -----------------

            Orphan @see Tags
              X Tests\UserServiceTest::test_old_method
                -> src/UserService.php:15

            Unresolved Placeholders
              ! @user-create  (1 production, 1 tests)

            Summary
            -------
              PHPUnit attribute links:  10
              Pest method chain links:  5
              @see tags:                8
              Total links:              23

              Issues found:             2
                Orphan @see tags:       1
                Unresolved placeholders: 1 (warning)

            OK Validation complete with issues.
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Types of issues TestLink catches:'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Orphan TestedBy'
              -
                type: text
                text: ' - '
              -
                type: text
                marks:
                  -
                    type: code
                text: '#[TestedBy]'
              -
                type: text
                text: ' points to a test that doesn''t exist'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Missing TestedBy'
              -
                type: text
                text: ' - Test has '
              -
                type: text
                marks:
                  -
                    type: code
                text: '#[LinksAndCovers]'
              -
                type: text
                text: ' but production has no '
              -
                type: text
                marks:
                  -
                    type: code
                text: '#[TestedBy]'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Unresolved placeholders'
              -
                type: text
                text: ' - '
              -
                type: text
                marks:
                  -
                    type: code
                text: '@placeholder'
              -
                type: text
                text: ' markers that haven''t been paired'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'FQCN issues'
              -
                type: text
                text: ' - '
              -
                type: text
                marks:
                  -
                    type: code
                text: '@see'
              -
                type: text
                text: ' tags using short class names instead of fully qualified names'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Use '
      -
        type: text
        marks:
          -
            type: code
        text: '--strict'
      -
        type: text
        text: ' in CI to fail on warnings as well as errors:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink validate --strict
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'The Sync Command (Auto-Link)'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Manually adding attributes to both production and test files gets tedious. The '
      -
        type: text
        marks:
          -
            type: code
        text: sync
      -
        type: text
        text: ' command propagates links bidirectionally.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        marks:
          -
            type: bold
        text: 'Add a link on either side.'
      -
        type: text
        text: ' Run sync. The other side gets updated.'
  -
    type: heading
    attrs:
      textAlign: left
      level: 2
    content:
      -
        type: text
        text: 'Forward Sync: Production -> Test'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'You add '
      -
        type: text
        marks:
          -
            type: code
        text: '#[TestedBy]'
      -
        type: text
        text: ' to production:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          #[TestedBy(UserServiceTest::class, 'test_creates_user')]
          public function create(): User { }
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Run sync:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink sync

            Syncing Coverage Links
            ----------------------

            Modified Files
              OK tests/Unit/UserServiceTest.php
                 + #[LinksAndCovers(UserService::class, 'create')]

            Summary
            -------
              Files modified:           1
  -
    type: heading
    attrs:
      textAlign: left
      level: 2
    content:
      -
        type: text
        text: 'Reverse Sync: Test -> Production'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'You add '
      -
        type: text
        marks:
          -
            type: code
        text: '#[LinksAndCovers]'
      -
        type: text
        text: ' to a test:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          #[LinksAndCovers(OrderService::class, 'process')]
          public function test_processes_order(): void { }
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Run sync:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink sync

            Syncing Coverage Links
            ----------------------

            Modified Files
              OK app/Services/OrderService.php
                 + #[TestedBy(OrderServiceTest::class, 'test_processes_order')]

            Summary
            -------
              Files modified:           1
  -
    type: set
    attrs:
      id: tl005
      values:
        type: sidenote
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Dry run first'
              -
                type: text
                text: ': Always preview changes with '
              -
                type: text
                marks:
                  -
                    type: code
                text: './vendor/bin/testlink sync --dry-run'
              -
                type: text
                text: ' before applying them. Especially in a 2,000-test codebase.'
        style: note
        position: right
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Use '
      -
        type: text
        marks:
          -
            type: code
        text: '--prune --force'
      -
        type: text
        text: ' to remove orphaned links that point to deleted code:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink sync --prune --force
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Links vs LinksAndCovers'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'TestLink offers two linking methods. The difference matters.'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: code
                text: 'linksAndCovers()'
              -
                type: text
                text: ' / '
              -
                type: text
                marks:
                  -
                    type: code
                text: '#[LinksAndCovers]'
              -
                type: text
                text: ' - This test is the '
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'primary coverage'
              -
                type: text
                text: ' for this method'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: code
                text: 'links()'
              -
                type: text
                text: ' / '
              -
                type: text
                marks:
                  -
                    type: code
                text: '#[Links]'
              -
                type: text
                text: ' - This test '
              -
                type: text
                marks:
                  -
                    type: bold
                text: uses
              -
                type: text
                text: ' this method but doesn''t ''own'' it'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'The rule of thumb: '
      -
        type: text
        marks:
          -
            type: bold
        text: '"If this test fails, is THIS method broken?"'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Yes'
              -
                type: text
                text: ' -> '
              -
                type: text
                marks:
                  -
                    type: code
                text: linksAndCovers()
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'No'
              -
                type: text
                text: ' -> '
              -
                type: text
                marks:
                  -
                    type: code
                text: 'links()'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Example from our codebase:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          // Unit test - provides coverage
          #[LinksAndCovers(PaymentService::class, 'charge')]
          public function test_charges_credit_card(): void
          {
              $payment = new PaymentService();
              $this->assertTrue($payment->charge(100));
          }

          // Integration test - uses it but doesn't own it
          #[Links(PaymentService::class, 'charge')]
          #[LinksAndCovers(CheckoutFlow::class, 'complete')]
          public function test_checkout_completes_successfully(): void
          {
              // Uses PaymentService::charge but isn't its primary test
              // The focus here is CheckoutFlow::complete
          }
  -
    type: set
    attrs:
      id: tl006
      values:
        type: sidenote
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'One method should have one or few tests claiming '
              -
                type: text
                marks:
                  -
                    type: code
                text: linksAndCovers
              -
                type: text
                text: ' coverage, but can have many tests using '
              -
                type: text
                marks:
                  -
                    type: code
                text: 'links()'
              -
                type: text
                text: ' for traceability.'
        style: note
        position: right
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'TDD Workflow with Placeholders'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'In Test-Driven Development, you write the test first. But the class doesn''t exist yet.'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          // Step 1: Write the failing test
          #[LinksAndCovers(PriceCalculator::class, 'calculate')]  // Error: Class not found!
          public function test_calculates_discount(): void
          {
              $calc = new PriceCalculator();
              $this->assertEquals(90, $calc->calculate(100, 0.1));
          }
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'You can''t use a class constant for a class that doesn''t exist. TestLink solves this with '
      -
        type: text
        marks:
          -
            type: bold
        text: placeholders
      -
        type: text
        text: ':'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          // Step 1: Write the test with a placeholder
          #[LinksAndCovers('@price-calc')]
          public function test_calculates_discount(): void
          {
              // ...
          }

          // Step 2: Write the production code with the same placeholder
          #[TestedBy('@price-calc')]
          public function calculate(int $price, float $discount): int
          {
              return (int) ($price * (1 - $discount));
          }

          // Step 3: Resolve placeholders
          $ ./vendor/bin/testlink pair
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Placeholders start with '
      -
        type: text
        marks:
          -
            type: code
        text: '@'
      -
        type: text
        text: ' followed by a letter, then any combination of letters, numbers, hyphens, or underscores. When you run '
      -
        type: text
        marks:
          -
            type: code
        text: 'testlink pair'
      -
        type: text
        text: ', placeholders are replaced with real class references:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink pair

            Pairing Placeholders
            --------------------

            Found Placeholders
              OK @price-calc    1 production x 1 tests = 1 links

            Summary
            -------
              Placeholders resolved:    1
              Files modified:           2

            OK Pairing complete.
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'After pairing, both files have real references:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          // Test file - AFTER
          #[LinksAndCovers(PriceCalculator::class, 'calculate')]
          public function test_calculates_discount(): void

          // Production file - AFTER
          #[TestedBy(PriceCalculatorTest::class, 'test_calculates_discount')]
          public function calculate(int $price, float $discount): int
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Auto-Fixing @see Tags'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'For Cmd+Click to work in your IDE, '
      -
        type: text
        marks:
          -
            type: code
        text: '@see'
      -
        type: text
        text: ' tags must use fully qualified class names (FQCN). Short names don''t navigate:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          // This doesn't work - IDE can't find the class
          /** @see UserServiceTest::creates_user */

          // This works - Cmd+Click navigates correctly
          /** @see \Tests\Unit\UserServiceTest::creates_user */
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'TestLink can auto-fix these using your '
      -
        type: text
        marks:
          -
            type: code
        text: use
      -
        type: text
        text: ' statements:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          $ ./vendor/bin/testlink validate --fix

            Validation Report
            -----------------

            FQCN Conversion Results
              OK src/Services/UserService.php
                 + UserServiceTest::creates_user
                   -> \Tests\Unit\UserServiceTest::creates_user

            OK Converted 1 @see tag(s) in 1 file(s).
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'CI Integration'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'TestLink validation belongs in your CI pipeline. Here''s a GitHub Actions example:'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          # .github/workflows/ci.yml
          name: CI

          on: [push, pull_request]

          jobs:
            test:
              runs-on: ubuntu-latest
              steps:
                - uses: actions/checkout@v4

                - name: Setup PHP
                  uses: shivammathur/setup-php@v2
                  with:
                    php-version: '8.2'

                - name: Install dependencies
                  run: composer install

                - name: Run tests
                  run: ./vendor/bin/phpunit

                - name: Validate TestLink
                  run: ./vendor/bin/testlink validate --strict
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Exit codes:'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: code
                text: '0'
              -
                type: text
                text: ' - All valid'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: code
                text: '1'
              -
                type: text
                text: ' - Validation errors (or warnings in strict mode)'
  -
    type: set
    attrs:
      id: tl007
      values:
        type: sidenote
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'Run '
              -
                type: text
                marks:
                  -
                    type: code
                text: 'testlink validate'
              -
                type: text
                text: ' '
              -
                type: text
                marks:
                  -
                    type: italic
                text: after
              -
                type: text
                text: ' your tests pass. A renamed method will break both tests and links - but fixing the tests should come first.'
        style: note
        position: right
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Scaling to 2,000 Tests'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Adopting TestLink in an existing codebase with 1,953 test files isn''t an all-or-nothing decision. Here''s our approach:'
  -
    type: heading
    attrs:
      textAlign: left
      level: 2
    content:
      -
        type: text
        text: 'Incremental Adoption'
  -
    type: orderedList
    attrs:
      start: 1
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Start with new code'
              -
                type: text
                text: ': Every new test and production method gets links. No exceptions.'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'High-value areas first'
              -
                type: text
                text: ': State machine guards and actions. Critical business logic. Code you touch often.'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Use path filtering'
              -
                type: text
                text: ': Validate and report on specific directories while migration is in progress.'
  -
    type: codeBlock
    attrs:
      language: null
    content:
      -
        type: text
        text: |
          # Validate only the migrated directories
          ./vendor/bin/testlink validate --path=app/Machines --path=app/Services/CreditBureau
  -
    type: heading
    attrs:
      textAlign: left
      level: 2
    content:
      -
        type: text
        text: 'What We Learned'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Sync is powerful'
              -
                type: text
                text: ': Adding links to one side and running sync saves significant time.'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'Validation catches drift'
              -
                type: text
                text: ': Refactored methods without updating links? CI fails. Links stay accurate.'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: 'It changes how you navigate'
              -
                type: text
                text: ': Once you''re used to Cmd+Click, grep feels ancient.'
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'The Organization + Navigation Stack'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Part VI gave us test organization - knowing '
      -
        type: text
        marks:
          -
            type: bold
        text: where
      -
        type: text
        text: ' tests live.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'TestLink gives us navigation - knowing '
      -
        type: text
        marks:
          -
            type: bold
        text: which
      -
        type: text
        text: ' tests cover what.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Together:'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: Organization
              -
                type: text
                text: ': "The test is in tests/Machines/Application/Guards/"'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: bold
                text: TestLink
              -
                type: text
                text: ': "Cmd+Click to go there. And here are all 4 tests that cover this guard."'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'The 5-second rule becomes reality: find any test in 5 seconds.'
  -
    type: horizontalRule
  -
    type: heading
    attrs:
      textAlign: left
      level: 1
    content:
      -
        type: text
        text: 'Closing'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'This brings us to the end of The Flaky Test Chronicles.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Over 7 parts, we''ve covered:'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'Time manipulation and Carbon'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'Database state and transactions'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'Queue handling and concurrency'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'External service mocking'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'Test isolation patterns'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'Test organization'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                text: 'Navigation with TestLink'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'None of this is theory. It''s 300+ commits across a production codebase with nearly 2,000 tests. The lessons are hard-won.'
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'TestLink is open source and available now:'
  -
    type: bulletList
    content:
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: link
                    attrs:
                      href: 'https://link.testflowlabs.dev/'
                      rel: null
                      target: _blank
                      title: null
                text: 'Documentation'
      -
        type: listItem
        content:
          -
            type: paragraph
            attrs:
              textAlign: left
            content:
              -
                type: text
                marks:
                  -
                    type: link
                    attrs:
                      href: 'https://github.com/testflowlabs/testlink'
                      rel: null
                      target: _blank
                      title: null
                text: GitHub
  -
    type: paragraph
    attrs:
      textAlign: left
    content:
      -
        type: text
        text: 'Your tests shouldn''t be mysteries. They should be one click away.'
---
